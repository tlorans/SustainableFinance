var documenterSearchIndex = {"docs":
[{"location":"Julia for IAM/scc/#Computing-Present-Day-Values-of-Damages","page":"Social Cost of Carbon","title":"Computing Present-Day Values of Damages","text":"","category":"section"},{"location":"Julia for IAM/scc/","page":"Social Cost of Carbon","title":"Social Cost of Carbon","text":"So, now that we have our estimated model, we need to convert future damages into their present-day values and sum to determine total damages:","category":"page"},{"location":"Julia for IAM/scc/","page":"Social Cost of Carbon","title":"Social Cost of Carbon","text":"# STEP 5 PRESENT VALUE OF DAMAGES IN BASELINE SCENARIO\ndiscount_rate = 0.035 # value recommended by the VBA\ndiscount_factors = [(1/(1 + discount_rate))^((t-1)) for t in 1:86] \ndamages_usd = getdataframe(m, :damages, :Ω)\npresent_value_damages = sum(discount_factors .* damages_usd[:,:Ω])","category":"page"},{"location":"Julia for IAM/scc/","page":"Social Cost of Carbon","title":"Social Cost of Carbon","text":"Which outputs:","category":"page"},{"location":"Julia for IAM/scc/","page":"Social Cost of Carbon","title":"Social Cost of Carbon","text":"35.86557996740484","category":"page"},{"location":"Julia for IAM/scc/","page":"Social Cost of Carbon","title":"Social Cost of Carbon","text":"That means a 35.8 trillion USD present-value of expected damages in our baseline scenario!","category":"page"},{"location":"Julia for IAM/scc/#Marginal-Model-and-SCC","page":"Social Cost of Carbon","title":"Marginal Model and SCC","text":"","category":"section"},{"location":"Julia for IAM/scc/","page":"Social Cost of Carbon","title":"Social Cost of Carbon","text":"Now, we just need to repeat the process by including an increase of 1 ton of CO_2 emitted (what we call the marginal model), compute the present-value of damages and the differential with the baseline model. This differential is the SCC!","category":"page"},{"location":"Julia for IAM/scc/","page":"Social Cost of Carbon","title":"Social Cost of Carbon","text":"# STEP 6 RUN THE MARGINAL MODEL AND COMPUTE THE SCC\n\nm2 = construct_model(marginal = true) # now we see the use of the marginal keyword!\nrun(m2)\n\ndamages_usd_m2 = getdataframe(m2, :damages, :Ω)\npresent_value_damages_m2 = sum(discount_factors .* damages_usd_m2[:,:Ω])\n\nscc = (present_value_damages_m2 - present_value_damages) * 10^12 # to express in USD per ton rather than trillion USD","category":"page"},{"location":"Julia for IAM/scc/","page":"Social Cost of Carbon","title":"Social Cost of Carbon","text":"Which gives the following SCC:","category":"page"},{"location":"Julia for IAM/scc/","page":"Social Cost of Carbon","title":"Social Cost of Carbon","text":"445.346870492358","category":"page"},{"location":"old/Environment/pollution/air_pollution/#Social-Cost-of-Air-Pollution","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"","category":"section"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"We propose here an illustrative and simplified one country model to value externalities linked with air pollution (fine particulate matter in this case).","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"Air pollution is really spatial and meteorological dependent. Specific Integrated Assessment Models for air quality have been developed, with granular geospatial assessment alongside dispersion model, in order to determine increase in concentration due to increase in pollutant emissions. ","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"However, this approach is location-specific and computationaly intensive. ","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"We propose here a roughly simplified approach, taken as given the exposure parameters and focusing on the health impact and valuation assessment.","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"The model is calibrated to roughly match the World Bank (2016) estimates.","category":"page"},{"location":"old/Environment/pollution/air_pollution/#The-Exposure-Component","page":"Social Cost of Air Pollution","title":"The Exposure Component","text":"","category":"section"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"Contrary to a full IAM model dedicated to air quality assessment, we switch here the dispersion modelling according to the emissions and the exposure computation based on population density grids and meteorological conditions. ","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"We use the data regarding average exposure as given from the World Bank.","category":"page"},{"location":"old/Environment/pollution/air_pollution/#Endogeneous-Variables","page":"Social Cost of Air Pollution","title":"Endogeneous Variables","text":"","category":"section"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"Notation Description Equation\nPop_PM_25 Population exposed to certain threshold of PM_25 Pop_PM_25 = Pop_PM_25 * Pop_Tot\nExceed_PM_25 Excess exposure to PM_25 in micro gram / m3 Exceed_PM_25 = mu_PM_25 - theta_PM_25","category":"page"},{"location":"old/Environment/pollution/air_pollution/#Parameters","page":"Social Cost of Air Pollution","title":"Parameters","text":"","category":"section"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"Notation Description\ntheta_PM_25 Threshold to PM_25 exposure in micro gram / m3\nmu_PM_25 Average PM_25 exposure in micro gram / m3","category":"page"},{"location":"old/Environment/pollution/air_pollution/#Julia-Implementation","page":"Social Cost of Air Pollution","title":"Julia Implementation","text":"","category":"section"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"using Mimi\n\n@defcomp exposure begin \n    \n    POP_25 = Variable(index = [time]) # Population exposed to certain threshold of PM2.5 concentration \n    Exceed_PM25 = Variable(index = [time]) # Excess micro gram exposure to PM2.5\n\n    Percent_POP_PM25 = Parameter() # Percentage of population exposed to certain threshold \n    Pop_Tot = Parameter() # Total population \n    θ_PM25 = Parameter() # Threshold to PM_25 exposure \n    μ_PM25 = Parameter() # Average PM_25 exposure\n\n    function run_timestep(p, v, d, t)\n        v.POP_25[t] = p.Percent_POP_PM25 * p.Pop_Tot\n        v.Exceed_PM25[t] = p.μ_PM25 - p.θ_PM25\n    end\n\nend","category":"page"},{"location":"old/Environment/pollution/air_pollution/#The-Human-Health-Component","page":"Social Cost of Air Pollution","title":"The Human Health Component","text":"","category":"section"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"Translating population exposure to human health impact involves the use of dose-response functions. This dose-response functions links, in that case, the exposure to fine particulate matter higher than a certain threshold and premature mortality cases.","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"Finally, to transform the premature mortality cases in monetary value, we use the Value of Statistical Life (VSL) concept, based on the Willingness to Pay (WTP) approach, which aims to estimate the willingness of individuals to pay for marginal reductions in their mortality. Such estimates are not available for every countries, and one need to determine a value transfer of this VSL, generally only available for some high income countries.","category":"page"},{"location":"old/Environment/pollution/air_pollution/#Endogeneous-Variables-2","page":"Social Cost of Air Pollution","title":"Endogeneous Variables","text":"","category":"section"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"Notation Description Equation\nMort Premature mortality Mort = alpha _0 * Exceed_PM_25 * Pop_PM_25\nOmega_Mort Health cost of premature mortality Omega_Mort = VSL * Mort\nVSL Value of statistical life VSL = VSL_OECD (fracyy_OECD)^e","category":"page"},{"location":"old/Environment/pollution/air_pollution/#Parameters-2","page":"Social Cost of Air Pollution","title":"Parameters","text":"","category":"section"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"Notation Description\nPop_PM_25 Population exposed to certain threshold of PM_25\nalpha _0 Dose response function of premature mortality\ny GDP per capita in the country of the activity considered\ny_OECD Average GDP per capita in OECD countries\ne Income elasticity of the VSL","category":"page"},{"location":"old/Environment/pollution/air_pollution/#Julia-Implementation-2","page":"Social Cost of Air Pollution","title":"Julia Implementation","text":"","category":"section"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"Let's implement this in Julia ","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"@defcomp human_health begin\n    \n    Mort = Variable(index = [time]) # Premature Mortality\n    Ω_Mort = Variable(index = [time]) # Health costs of premature Mortality\n    VSL = Variable(index = [time]) # Value of statistical life\n\n    POP_25 = Parameter(index = [time]) # Population exposed to certain threshold of PM 2.5\n    Exceed_PM25 = Parameter(index = [time]) # Excess exposure in micro gram / m3\n\n    alpha_0 = Parameter() # Dose response function of premature mortality \n    y = Parameter() # GDP per capita in the country of the activity \n    y_OECD = Parameter() # Average GDP per capita in the OECD countries \n    e = Parameter() # Income elasticity of VSL\n    VSL_OECD = Parameter() # Value of statistic life of reference\n\n    function run_timestep(p, v, d, t)\n        v.Mort[t] = p.alpha_0 * p.Exceed_PM25[t] * p.POP_25[t]\n        v.VSL[t] = p.VSL_OECD * (p.y / p.y_OECD)^(p.e)\n        v.Ω_Mort[t] = v.VSL[t] * v.Mort[t]\n    end\nend","category":"page"},{"location":"old/Environment/pollution/air_pollution/#Binding-All-Components-Together","page":"Social Cost of Air Pollution","title":"Binding All Components Together","text":"","category":"section"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"Finally, we can combine the exposure and human_health together. We use data for China.","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"\nfunction construct_model()\n\n    m = Model()\n    set_dimension!(m, :time, collect(1:1)) # we only have data for one year here and no projection\n\n    add_comp!(m, exposure)\n    add_comp!(m, human_health)\n\n    update_param!(m, :exposure, :Percent_POP_PM25, 1.) # China\n    update_param!(m, :exposure, :Pop_Tot, 1.4*10^9) # China\n    update_param!(m, :exposure, :θ_PM25, 35)\n    update_param!(m, :exposure, :μ_PM25, 53) # China\n\n    update_param!(m, :human_health, :alpha_0, 0.000134) \n    update_param!(m, :human_health, :y, 10500.) \n    update_param!(m, :human_health, :y_OECD, 37000.) \n    update_param!(m, :human_health, :e, 0.8) \n    update_param!(m, :human_health, :VSL_OECD, 1. * 10^6) \n\n    connect_param!(m, :human_health, :POP_25, :exposure, :POP_25)\n    connect_param!(m, :human_health, :Exceed_PM25, :exposure, :Exceed_PM25)\n\n    return m\nend","category":"page"},{"location":"old/Environment/pollution/air_pollution/#Computing-Cost-of-Air-Pollution","page":"Social Cost of Air Pollution","title":"Computing Cost of Air Pollution","text":"","category":"section"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"Let's run the model first:","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"m = construct_model()\nrun(m)","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"Let's see by how much the average exposure to particulate matter is higher than the limit threshold:","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"getdataframe(m, :human_health, :Exceed_PM25)","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"Which gives a value of 18 micro gram per m3:","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"│ Row │ time  │ Exceed_PM25 │\n│     │ Int64 │ Float64?    │\n├─────┼───────┼─────────────┤\n│ 1   │ 1     │ 18.0        │","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"According to the World Bank, all the Chinese population was exposed to such particulate matter concentration in 2017. This leads to the following estimate of number of premature deaths:","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"getdataframe(m, :human_health, :Mort)","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"1×2 DataFrame\n│ Row │ time  │ Mort     │\n│     │ Int64 │ Float64? │\n├─────┼───────┼──────────┤\n│ 1   │ 1     │ 3.3768e6 │","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"We also find the following value for VSL in China:","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"getdataframe(m, :human_health, :VSL)","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"│ Row │ time  │ VSL       │\n│     │ Int64 │ Float64?  │\n├─────┼───────┼───────────┤\n│ 1   │ 1     │ 3.65082e5 │","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"Which gives the following estimates in USD:","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"value_baseline = getdataframe(m, :human_health, :Ω_Mort)","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"│ Row │ time  │ Ω_Mort     │\n│     │ Int64 │ Float64?   │\n├─────┼───────┼────────────┤\n│ 1   │ 1     │ 1.23281e12 │","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"Let's express it in percentage of China's GDP to get a better sense of this value:","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"getdataframe(m, :human_health, :Ω_Mort)[1, :Ω_Mort]/ (14722730.70 * 10^6)","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"0.08373500119660764","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"According to this estimate, the air pollution costs around 8.4% of GDP equivalent in terms of negative externatilities. This is quite close to the World Bank estimates (2016).","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"Last but not least, we can use this estimate to derive a social cost per ton of fine particulate matter in China.  To do so, we use as a proxy the ratio health costs in USD and the amount of emitted fine particulate matter in China, expressed in ton:","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"china_PM25 = 9926.4 * 10^(3)\n\nsocial_cost = getdataframe(m, :human_health, :Ω_Mort)[1, :Ω_Mort] / china_PM25 ","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"Which gives:","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"124194.8614585179","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"According to this simplistic model, the social cost of fine particulate matter in China is then at 124,195 per ton.  This high price is noteworthy due to the already high (and above health limits) concentration in the country. ","category":"page"},{"location":"old/Environment/pollution/air_pollution/#The-APEEP-Platform","page":"Social Cost of Air Pollution","title":"The APEEP Platform","text":"","category":"section"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"While the approach presented above is quite simplistic, one can learn more about more realistic air pollution damages assessment with the use of the Air Pollution Emission Experiments and Policy Analysis (APEEP) model. It is an integrated assessment model that links emissions of air poluution to exposures, physical effects and monetary damages in the contiguous United States. ","category":"page"},{"location":"old/Environment/pollution/air_pollution/","page":"Social Cost of Air Pollution","title":"Social Cost of Air Pollution","text":"(Image: IMAGE ALT TEXT HERE)","category":"page"},{"location":"Julia for IAM/damages_component/#The-Damages-Component","page":"Damages Component","title":"The Damages Component","text":"","category":"section"},{"location":"Julia for IAM/damages_component/","page":"Damages Component","title":"Damages Component","text":"The Damages Component use the Damage function formulated by Weitzman (2012), with a calibration such as the damages in percentage of gross output is equal to 50% when the increase in atmospheric temperature is at 6°C.","category":"page"},{"location":"Julia for IAM/damages_component/#Endogeneous-Variables","page":"Damages Component","title":"Endogeneous Variables","text":"","category":"section"},{"location":"Julia for IAM/damages_component/","page":"Damages Component","title":"Damages Component","text":"Notation Description Equation\nD_t Damages (in % of Gross output) D_t = 1 - frac11 + eta_1 T_AT_t + eta_2 * T_AT_t^2 + eta_3 * T_AT_t^6754\nOmega_t Damages in USD Omega_t = D_tY_t","category":"page"},{"location":"Julia for IAM/damages_component/#Parameters","page":"Damages Component","title":"Parameters","text":"","category":"section"},{"location":"Julia for IAM/damages_component/","page":"Damages Component","title":"Damages Component","text":"Notation Description\neta_1 Parameter of damage function\neta_2 Parameter of damage function\neta_3 Parameter of damage function","category":"page"},{"location":"Julia for IAM/damages_component/#Exogeneous-Variables","page":"Damages Component","title":"Exogeneous Variables","text":"","category":"section"},{"location":"Julia for IAM/damages_component/","page":"Damages Component","title":"Damages Component","text":"Notation Description\nT_AT_t Atmospheric temperature over pre-industrial levels (°C)\nY_t Gross output","category":"page"},{"location":"Julia for IAM/damages_component/#Julia-Implementation","page":"Damages Component","title":"Julia Implementation","text":"","category":"section"},{"location":"Julia for IAM/damages_component/","page":"Damages Component","title":"Damages Component","text":"Let's implement it in Julia:","category":"page"},{"location":"Julia for IAM/damages_component/","page":"Damages Component","title":"Damages Component","text":"\n# component for damages \n@defcomp damages begin\n    D = Variable(index = [time]) # Damages (in % of gross output)\n    Ω = Variable(index  = [time]) # Damages in USD\n\n    η₁ = Parameter() # Parameter of damage function \n    η₂ = Parameter() # Parameter of damage function \n    η₃ = Parameter() # Parameter of damage function \n\n    T_AT = Parameter(index = [time]) # Atmospheric temperature increase \n    Y = Parameter(index = [time]) # Gross output \n\n    function run_timestep(p, v, d, t)\n\n        v.D[t] = 1 - 1 / (1 + p.η₁ * p.T_AT[t] + p.η₂ * p.T_AT[t]^2 + p.η₃ * p.T_AT[t]^6.754)\n        v.Ω[t] = v.D[t] * p.Y[t]\n        \n    end\n\nend","category":"page"},{"location":"Julia for IAM/emissions_component/#The-Emissions-Component","page":"Emissions Component","title":"The Emissions Component","text":"","category":"section"},{"location":"Julia for IAM/emissions_component/","page":"Emissions Component","title":"Emissions Component","text":"The emissions component is also really simplistic. The energy consumption is modelled as a function of the energy to output ratio and the gross output. Then the emissions are driven by the carbon intensity of the energy mix and the energy consumption. ","category":"page"},{"location":"Julia for IAM/emissions_component/","page":"Emissions Component","title":"Emissions Component","text":"Note that the gross output is treated as an exogenous variable here.","category":"page"},{"location":"Julia for IAM/emissions_component/#Endogeneous-Variable","page":"Emissions Component","title":"Endogeneous Variable","text":"","category":"section"},{"location":"Julia for IAM/emissions_component/","page":"Emissions Component","title":"Emissions Component","text":"Notation Description Equation\nM_t Energy necessary for the production of output M_t = epsilon_t * Y_t\nE_t Total greenhouse gas emissions E_t = omega_t * M_t","category":"page"},{"location":"Julia for IAM/emissions_component/#Exogeneous-Variables","page":"Emissions Component","title":"Exogeneous Variables","text":"","category":"section"},{"location":"Julia for IAM/emissions_component/","page":"Emissions Component","title":"Emissions Component","text":"Notation Description\nepsilon_t Energy to output ratio (EJ/trillion USD)\nomega_t CO_2 intensity (Gt/EJ)\nY_t Gross output","category":"page"},{"location":"Julia for IAM/emissions_component/#Julia-Implementation","page":"Emissions Component","title":"Julia Implementation","text":"","category":"section"},{"location":"Julia for IAM/emissions_component/","page":"Emissions Component","title":"Emissions Component","text":"Let's implement it in Julia:","category":"page"},{"location":"Julia for IAM/emissions_component/","page":"Emissions Component","title":"Emissions Component","text":"\n# component for greenhouse gas emissions \n@defcomp emissions begin \n    E = Variable(index = [time]) # Total greenhouse gas emissions \n    M = Variable(index = [time]) # Energy consumption\n\n    ω = Parameter(index = [time]) # CO2 intensity of energy mix\n    ϵ = Parameter(index = [time]) # energy intensity of output\n    Y = Parameter(index = [time]) # Gross output - now a Parameter\n\n    function run_timestep(p, v, d, t)\n        # equation for M \n        v.M[t] = p.ϵ[t] * p.Y[t] # note the p. in front of gross \n        # Define an equation for E \n        v.E[t] = p.ω[t] * v.M[t]\n    end\nend","category":"page"},{"location":"Julia for IAM/intro/#Integrated-Assessment-Models","page":"Integrated Assessment Models","title":"Integrated Assessment Models","text":"","category":"section"},{"location":"Julia for IAM/intro/","page":"Integrated Assessment Models","title":"Integrated Assessment Models","text":"Integrated Assessment Models (IAMs) are economic models, coupled with climate component, used to determine future outcomes from climate change. Based on these models, the SCC is computed in four steps:","category":"page"},{"location":"Julia for IAM/intro/","page":"Integrated Assessment Models","title":"Integrated Assessment Models","text":"Predict future emissions based on population, economic growth and other factors\nModel future climate responses, such as temperature increase and sea level changes \nAssess the economic impact of these climatic changes on agriculture, health, energy use and other aspects of the economy\nConvert future damages into their present-day values and sum to determine total damages ","category":"page"},{"location":"Julia for IAM/intro/","page":"Integrated Assessment Models","title":"Integrated Assessment Models","text":"These four steps provide a baseline value for the damages caused by emissions. The modelling process is then repeated after including a small amount of additional emissions to determine the impact on the total cost of emissions-related damages.  The increase in damages from the additional emissions provides an estimated of the SCC.","category":"page"},{"location":"Julia for IAM/intro/","page":"Integrated Assessment Models","title":"Integrated Assessment Models","text":"To illustrate the process and the Mimi Framework we will use, let's illustrate the process with a simple illustrative one region model.","category":"page"},{"location":"Climate Valuation/Impacts/impacts/#Impacts","page":"Impacts","title":"Impacts","text":"","category":"section"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"To decompose and assess various damages due to climate change, we will use the FUND model.","category":"page"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"This model is a so-called Integrated Assessment Model of climate change and is often used for studying impacts of climate change in a dynamic context. ","category":"page"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"We will focus here on the impacts valuation / decomposition.","category":"page"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"We will use the Mimi Framework and the model made available as a Julia package MimiFUND.","category":"page"},{"location":"Climate Valuation/Impacts/impacts/#Agriculture-Impacts","page":"Impacts","title":"Agriculture Impacts","text":"","category":"section"},{"location":"Climate Valuation/Impacts/impacts/#Endogenous-Variables","page":"Impacts","title":"Endogenous Variables","text":"","category":"section"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"Notation Description Equation\nA^r_tr Impacts due to the rate of climate change A^r_tr = alpha_r (fracDelta T_t004)^beta + (1-frac1rho) A^r_t-1r\nA^l_tr Damages in agriculture production as a fraction due to the level of climate change A^l_tr = delta^l_r T_t + delta^q_r T_t^2\nA^f_tr CO2 fertilization impacts A^f_tr = fracgamma_rln2lnfracCO2_t275\nA_tr Impacts of climate change on agriculture A_tr = A^r_tr + A^l_tr + A^f_tr","category":"page"},{"location":"Climate Valuation/Impacts/impacts/#Parameters","page":"Impacts","title":"Parameters","text":"","category":"section"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"Notation Description\nDelta T Change in the regional mean temperature (in degree Celsius) between time t and t-1\nalpha Regional change in agriculture production for an annual warming of 0.04°C\nbeta Non-linearity of the reaction to temperature\nrho Speed of adaptation\nT Global mean temperature above pre-industrial (in degree Celsius)\ndelta^l_r Parameter for the damages function on agriculture production due to the level of climate change\ndelta^q_r Parameter for the damages function on agriculture production due to the level of climate change\nCO2 Atmospheric concentration of carbon dioxide (in parts per million by volume)\ngamma Impacts of doubling of CO2 concentrations\nfracGAP_trY_tr Share of agriculture production in total income","category":"page"},{"location":"Climate Valuation/Impacts/impacts/#Damages","page":"Impacts","title":"Damages","text":"","category":"section"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"The baseline scenario corresponds to the one with an increase of 3.5°C compared to pre-industrial level by 2100.","category":"page"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"Now, let's run the baseline model in Julia:","category":"page"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"using Mimi\nusing MimiFUND\n\n# Run FUND for baseline scenario\nm = MimiFUND.get_model()\n\nset_dimension!(m, :time, 1950:2100) # set the timeline to be 1950 to 2100\n\nrun(m)","category":"page"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"You can explore all results:","category":"page"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"explore(m)","category":"page"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"You can see the impacts associated with the level of climate change:","category":"page"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"p = Mimi.plot(m, :impactagriculture, :aglevel)","category":"page"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"(Image: \"aglevel\")","category":"page"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"The impacts of the rate of climate change:","category":"page"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"p = Mimi.plot(m, :impactagriculture, :agrate)","category":"page"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"(Image: \"agrate\")","category":"page"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"And, finally, the overall expected impacts on agriculture:","category":"page"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"p = Mimi.plot(m, :impactagriculture, :agcost)","category":"page"},{"location":"Climate Valuation/Impacts/impacts/","page":"Impacts","title":"Impacts","text":"(Image: \"agcosts\")","category":"page"},{"location":"Climate Valuation/Impacts/impacts/#Ecosystems-Impacts","page":"Impacts","title":"Ecosystems Impacts","text":"","category":"section"},{"location":"Climate Valuation/Impacts/impacts/#Energy-Consumption-Impacts","page":"Impacts","title":"Energy Consumption Impacts","text":"","category":"section"},{"location":"Climate Valuation/Impacts/impacts/#Forestry-Impacts","page":"Impacts","title":"Forestry Impacts","text":"","category":"section"},{"location":"Climate Valuation/Impacts/impacts/#Sea-Level-Rise-Impacts","page":"Impacts","title":"Sea Level Rise Impacts","text":"","category":"section"},{"location":"Climate Valuation/Impacts/impacts/#Mortality-Impacts","page":"Impacts","title":"Mortality Impacts","text":"","category":"section"},{"location":"Climate Valuation/Impacts/impacts/#Human-Health-Impacts","page":"Impacts","title":"Human Health Impacts","text":"","category":"section"},{"location":"Climate Valuation/Impacts/impacts/#Extreme-Weather-Impacts","page":"Impacts","title":"Extreme Weather Impacts","text":"","category":"section"},{"location":"Climate Valuation/Impacts/impacts/#Water-Resources-Impacts","page":"Impacts","title":"Water Resources Impacts","text":"","category":"section"},{"location":"Julia for IAM/all_together/#Binding-All-Components-Together","page":"-","title":"Binding All Components Together","text":"","category":"section"},{"location":"Julia for IAM/all_together/","page":"-","title":"-","text":"We can now use Mimito bind the grosseconomy, the emissions, the climate and the damages components together, in order to solve for the emissions level of the global economy over time and the resulting damages.","category":"page"},{"location":"Julia for IAM/all_together/","page":"-","title":"-","text":"# STEP 2: CONSTRUCT A MODEL BY BINDING BOTH COMPONENTS \n\n# if anay variables of one component are parameters for another, connect_param! is\n# used to couple the two\n\nfunction construct_model(;marginal = false)\n    m = Model()\n\n    set_dimension!(m, :time, collect(2015:1:2100))\n\n    # Order matters here, if the emissions component defined first, error\n    add_comp!(m, grosseconomy)\n    add_comp!(m, emissions)\n    add_comp!(m, climate)\n    add_comp!(m, damages)\n\n    \"\"\"\n    update_param! used to assign values each component parameter \n    with an external connection to an unshared model param \n    \"\"\"\n    # Update parameters for the grosseconomy component\n    update_param!(m, :grosseconomy, :L, [(1. + 0.003)^t * 6.404 for t in 1:86])\n    update_param!(m, :grosseconomy, :TFP, [(1 + 0.01)^t * 3.57 for t in 1:86])\n    update_param!(m, :grosseconomy, :s, ones(86) .* 0.22)\n    update_param!(m, :grosseconomy, :δ, 0.1)\n    update_param!(m, :grosseconomy, :k0, 130.)\n    update_param!(m, :grosseconomy, :β, 0.3)\n\n    # update parameters for the emissions component \n    update_param!(m, :emissions, :ω, [(1. - 0.002)^t * 0.07 for t in 1:86])\n    \n    if marginal # we'll see later the use of this\n        pulse = 1/1e10 # units of emissions are Gt then we convert 1 ton of pulse in Gt \n        update_param!(m, :emissions, :ϵ, [(1. - 0.002)^t * (7.92 + pulse) for t in 1:86])\n    else\n        update_param!(m, :emissions, :ϵ, [(1. - 0.002)^t * 7.92 for t in 1:86])\n    end\n\n    # update parameters for the climate component \n    update_param!(m, :climate, :CO2_AT_0, 3120)\n    update_param!(m, :climate, :CO2_UP_0, 5628.8)\n    update_param!(m, :climate, :CO2_LO_0, 36706.7)\n    update_param!(m, :climate, :F_0, 2.30)\n    update_param!(m, :climate, :FEX_0, 0.28)\n    update_param!(m, :climate, :T_AT_0, 1.0)\n    update_param!(m, :climate, :T_LO_0, 0.0068)\n\n    update_param!(m, :climate, :CO2_AT_PRE, 2156.2)\n    update_param!(m, :climate, :CO2_LO_PRE, 36670.0)\n    update_param!(m, :climate, :CO2_UP_PRE, 4950.5)\n    update_param!(m, :climate, :F2CO2, 3.8)\n    update_param!(m, :climate, :fex, 0.005)\n    update_param!(m, :climate, :ϕ_11, 0.9817)\n    update_param!(m, :climate, :ϕ_12, 0.0183)\n    update_param!(m, :climate, :ϕ_21, 0.0080)\n    update_param!(m, :climate, :ϕ_22, 0.9915)\n    update_param!(m, :climate, :ϕ_23, 0.0005)\n    update_param!(m, :climate, :ϕ_32, 0.0001)\n    update_param!(m, :climate, :ϕ_33, 0.9999)\n    update_param!(m, :climate, :t_1, 0.027)\n    update_param!(m, :climate, :t_2, 0.018)\n    update_param!(m, :climate, :t_3, 0.005)\n    update_param!(m, :climate, :S, 3)\n\n    # update parameters for damages function \n\n    update_param!(m, :damages, :η₁, 0)\n    update_param!(m, :damages, :η₂, 0.00284)\n    update_param!(m, :damages, :η₃, 0.000005)\n\n    # connect parameters for the emissions component \n    connect_param!(m, :emissions, :Y, :grosseconomy, :Y)\n\n    # connect parameters for the climate component \n    connect_param!(m, :climate, :E, :emissions, :E)\n\n    # connect parameters for the damages component\n    connect_param!(m, :damages, :T_AT, :climate, :T_AT)\n    connect_param!(m, :damages, :Y, :grosseconomy, :Y)\n\n    return m\nend","category":"page"},{"location":"Julia for IAM/all_together/","page":"-","title":"-","text":"Now, we can run the model and examine the results:","category":"page"},{"location":"Julia for IAM/all_together/","page":"-","title":"-","text":"m = construct_model()\nrun(m)\n\n# Check model resutls \ngetdataframe(m, :emissions, :E)","category":"page"},{"location":"Julia for IAM/all_together/","page":"-","title":"-","text":"And we can vizualize the results via plotting and explorer:","category":"page"},{"location":"Julia for IAM/all_together/","page":"-","title":"-","text":"# Plot model results\nMimi.plot(m, :grosseconomy, :Y)\nMimi.plot(m, :emissions, :E)\nMimi.plot(m, :climate, :T_AT)\nMimi.plot(m, :damages, :D)","category":"page"},{"location":"Julia for IAM/all_together/","page":"-","title":"-","text":"So, what does our simplistic model tell us?","category":"page"},{"location":"Julia for IAM/all_together/","page":"-","title":"-","text":"First, the output should continue to grow according to our hypothesis, up to hundreds of trillion USD! ","category":"page"},{"location":"Julia for IAM/all_together/","page":"-","title":"-","text":"(Image: \"output\")","category":"page"},{"location":"Julia for IAM/all_together/","page":"-","title":"-","text":"Second, due to our assumptions on the carbon intensity and energy intensity evolutions, alongside the economic growth, the emissions should grow such as:","category":"page"},{"location":"Julia for IAM/all_together/","page":"-","title":"-","text":"(Image: \"emissions\")","category":"page"},{"location":"Julia for IAM/all_together/","page":"-","title":"-","text":"Due to these emissions, the atmospheric temperature should increase by 3.5°C by the end of the century.","category":"page"},{"location":"Julia for IAM/all_together/","page":"-","title":"-","text":"(Image: \"T_AT\")","category":"page"},{"location":"Julia for IAM/all_together/","page":"-","title":"-","text":"Which could result to up to 6.5% of yearly GDP damages by 2100:","category":"page"},{"location":"Julia for IAM/all_together/","page":"-","title":"-","text":"(Image: \"damages\")","category":"page"},{"location":"Julia for IAM/all_together/","page":"-","title":"-","text":"You can also explore interactively all the variables in your model with the following command:","category":"page"},{"location":"Julia for IAM/all_together/","page":"-","title":"-","text":"# Observe all model result graphs in UI\nexplore(m)","category":"page"},{"location":"Climate Valuation/Social Cost/social_costs/#Social-Cost","page":"Social Cost","title":"Social Cost","text":"","category":"section"},{"location":"Climate Valuation/Social Cost/social_costs/","page":"Social Cost","title":"Social Cost","text":"We define the social cost of a greenhouse gas as the net present value of the change in future damages from a marginal (1 tonne) change in emissions of that gas today. ","category":"page"},{"location":"Climate Valuation/Social Cost/social_costs/","page":"Social Cost","title":"Social Cost","text":"In order to estimate the social cost of a greenhouse gas, the model need to first compute the difference between total monetised climate change impacts of business as usual emissions and a path with slightly higher emissions.","category":"page"},{"location":"Climate Valuation/Social Cost/social_costs/","page":"Social Cost","title":"Social Cost","text":"Then, the differences in monetized climate change impacts are discounted back to the chosen year (2020 here) and normalised by the difference in emission (namely, 1 tonne)","category":"page"},{"location":"Climate Valuation/Social Cost/social_costs/#Marginal-Model","page":"Social Cost","title":"Marginal Model","text":"","category":"section"},{"location":"Climate Valuation/Social Cost/social_costs/","page":"Social Cost","title":"Social Cost","text":"It is simply done in Julia:","category":"page"},{"location":"Climate Valuation/Social Cost/social_costs/","page":"Social Cost","title":"Social Cost","text":"scc_year = 2020\n\nupdate_param!(m, :climatedynamics, :climatesensitivity, 4.5)\n\nmm = MimiFUND.get_marginal_model(m, year = scc_year)   # The additional emissions pulse will be added in the specified year","category":"page"},{"location":"Climate Valuation/Social Cost/social_costs/#Social-Cost-of-Carbon","page":"Social Cost","title":"Social Cost of Carbon","text":"","category":"section"},{"location":"Climate Valuation/Social Cost/social_costs/","page":"Social Cost","title":"Social Cost","text":"MimiFUND.compute_scc(m, year = scc_year, eta = 1., prtp = 0.) * 1.68 # +68% inflation between 1995 and 2020","category":"page"},{"location":"Climate Valuation/Social Cost/social_costs/","page":"Social Cost","title":"Social Cost","text":"  Which gives:","category":"page"},{"location":"Climate Valuation/Social Cost/social_costs/","page":"Social Cost","title":"Social Cost","text":"51.32718736191957","category":"page"},{"location":"Julia for IAM/climate_component/#The-Climate-Component","page":"Climate Component","title":"The Climate Component","text":"","category":"section"},{"location":"Julia for IAM/climate_component/","page":"Climate Component","title":"Climate Component","text":"The formulation below of climate dynamics linked to emissions follows the traditional integrated assessment models.  The emissions increase the atmospheric CO_2 concentration alongside the carbon cycle. The carbon cycle shows that every year there is exchange of carbon between the atmosphere and the upper ocean/biosphere and between the upper ocean/biosphere and the lower ocean. ","category":"page"},{"location":"Julia for IAM/climate_component/","page":"Climate Component","title":"Climate Component","text":"The accumulation of atmospheric CO_2 concentration increases radiative forcing, placing upward pressures on the atmospheric temperature.","category":"page"},{"location":"Julia for IAM/climate_component/","page":"Climate Component","title":"Climate Component","text":"Note that emissions are taken as exogenous in this component. ","category":"page"},{"location":"Julia for IAM/climate_component/#Endogeneous-Variables","page":"Climate Component","title":"Endogeneous Variables","text":"","category":"section"},{"location":"Julia for IAM/climate_component/","page":"Climate Component","title":"Climate Component","text":"Notation Description Equation\nCO2_AT_t Atmospheric CO_2 concentration (Gt) CO2_AT_t = E_t + phi_11CO2_AT_t-1 + phi_21 CO2_UP_t-1\nCO2_UP_t Upper ocean/biosphere CO_2 concentration (Gt) CO2_UP_t = phi_12CO2_AT_t-1+phi_22CO2_UP_t-1 + phi_32CO2_LO_t-1\nCO2_LO_t Lower ocean CO_2 concentration (Gt) CO2_LO_t = phi_23CO2_UP_t-1 + phi_33CO2_LO_t-1\nF_t Radiative forcing over pre-industrial levels (W/m2) F_t = F_2*CO2 log2fracCO2_AT_tCO2_AT-PRE + F_EX_t\nF_EX_t Radiative forcing over pre-industrial levels, due to non CO_2 greenhouse gases (W/m2) F_EX_t = F_EX_t-1 + fex\nT_AT_t Atmospheric temperature over pre-industrial levels (°C) T_AT_t = T_AT_t-1 + t_1(F_t - fracF_2*CO2ST_AT_t-1 - t_2(T_AT_t-1 - T_LO_t-1))\nT_LO_t Lower ocean temperature over pre-industrial levels (°C) T_LO_t = T_LO_t-1 + t_3(T_AT_t-1 - T_LO_t-1)","category":"page"},{"location":"Julia for IAM/climate_component/#Parameters","page":"Climate Component","title":"Parameters","text":"","category":"section"},{"location":"Julia for IAM/climate_component/","page":"Climate Component","title":"Climate Component","text":"Notation Description\nCO2_AT-PRE Pre-industrial CO_2 concentration in atmosphere (Gt)\nCO2_LO-PRE Pre-industrial CO_2 concentration in lower ocean (Gt)\nCO2_UP-PRE Pre-industrial CO_2 concentration in upper ocean / biosphere (Gt)\nF_2*CO2 Increase in radiative forcing (since the pre-industrial period) due to doubling of CO_2 concentration from pre-industrial levels (W/m2)\nfex Annual increase in radiative forcing (since the pre-industrial period) due to non-CO_2 agents (W/m2)\nphi_11 Transfer coefficient for carbon from the atmosphere to the atmosphere\nphi_12 Transfer coefficient for carbon from the atmosphere to the upper ocean/biosphere\nphi_21 Transfer coefficient for carbon from the upper ocean/biosphere to the atmosphere\nphi_22 Transfer coefficient for carbon from the upper ocean/biosphere to the upper ocean/biosphere\nphi_23 Transfer coefficient for carbon from the upper ocean/biosphere to the lower ocean\nphi_32 Transfer coefficient for carbon from the lower ocean to the upper ocean/biosphere\nphi_33 Transfer coefficient for carbon from the lower ocean to the lower ocean\nt_1 Speed of adjustment parameter in the atmospheric temperature equation\nt_2 Coefficient of heat loss from the atmosphere to the lower ocean (atmospheric temperature equation)\nt_3 Coefficient of heat loss from the atmosphere to the lower ocean (lower ocean temperature equation)\nS Equilibrium climate sensitivity","category":"page"},{"location":"Julia for IAM/climate_component/#Exogeneous-Variables","page":"Climate Component","title":"Exogeneous Variables","text":"","category":"section"},{"location":"Julia for IAM/climate_component/","page":"Climate Component","title":"Climate Component","text":"Notation Description\nE_t Total greenhouse gas emissions","category":"page"},{"location":"Julia for IAM/climate_component/#Julia-Implementation","page":"Climate Component","title":"Julia Implementation","text":"","category":"section"},{"location":"Julia for IAM/climate_component/","page":"Climate Component","title":"Climate Component","text":"We can implement it in Julia:","category":"page"},{"location":"Julia for IAM/climate_component/","page":"Climate Component","title":"Climate Component","text":"# component for climate \n@defcomp climate begin\n    CO2_AT = Variable(index = [time]) # Atmospheric CO2 concentration \n    CO2_UP = Variable(index = [time]) # Upper ocean CO2 concentration \n    CO2_LO = Variable(index = [time]) # Lower ocean CO2 concentration \n    F = Variable(index = [time]) # Radiative forcing \n    FEX = Variable(index = [time]) # Radiative forcing due to non CO2 \n    T_AT = Variable(index = [time]) # Atmospheric temperature over pre-industrial levels \n    T_LO = Variable(index = [time]) # Lower ocean tempature over pre-industrial levels \n\n    CO2_AT_0 = Parameter() # Initial value for CO2_AT\n    CO2_UP_0 = Parameter() # Initial value for CO2_UP\n    CO2_LO_0 = Parameter() # Initial value for CO2_LO\n    F_0 = Parameter() # Initial value for F\n    FEX_0 = Parameter() # Initial value for FEX\n    T_AT_0 = Parameter() # Initial value for T_AT\n    T_LO_0 = Parameter() # Initial value for T_LO\n\n    CO2_AT_PRE = Parameter() # Pre-industrial CO2 concentration in atmosphere \n    CO2_LO_PRE = Parameter() # Pre-industrial CO2 concentration in lower ocean \n    CO2_UP_PRE = Parameter() # Pre-industrial CO2 concentration in upper ocean \n    F2CO2 = Parameter() # Increase in radiative forcing (since the pre-industrial period) due to doubling of CO2\n    fex = Parameter() # Annual increase in radiative forcing (since the pre-industrial level)\n    ϕ_11 = Parameter() # Transfer coefficient for carbon from the atmosphere to the atmosphere\n    ϕ_12 = Parameter() # Transfer coefficient for carbon from the atmosphere to the upper ocean/biosphere\n    ϕ_21 = Parameter() # Transfer coefficient for carbon from the upper ocean/biosphere to the atmosphere\n    ϕ_22 = Parameter() # Transfer coefficient for carbon from the upper ocean/biosphere to the upper ocean/biosphere\n    ϕ_23 = Parameter() # Transfer coefficient for carbon from the upper ocean/biosphere to the lower ocean\n    ϕ_32 = Parameter() # Transfer coefficient for carbon from the lower ocean to the upper ocean/biosphere\n    ϕ_33 = Parameter() # Transfer coefficient for carbon from the lower ocean to the lower ocean\n    t_1 = Parameter() # Speed of adjustment parameter in the atmospheric temperature equation\n    t_2 = Parameter() # Coefficient of heat loss from the atmosphere to the lower ocean (atmospheric temperature equation)\n    t_3 = Parameter() # Coefficient of heat loss from the atmosphere to the lower ocean (lower ocean temperature equation)\n    S = Parameter() # Equilibrium climate sensitivity \n    \n    \n    E = Parameter(index = [time]) # Total greenhouse gas emissions\n\n    function run_timestep(p, v, d, t)\n        if is_first(t)\n            v.CO2_AT[t] = p.CO2_AT_0\n            v.CO2_UP[t] = p.CO2_UP_0\n            v.CO2_LO[t] = p.CO2_LO_0\n            v.FEX[t] = p.FEX_0\n            v.F[t] = p.F_0\n            v.T_AT[t] = p.T_AT_0\n            v.T_LO[t] = p.T_LO_0\n        else\n            # Equation for CO2_AT\n            v.CO2_AT[t] = p.E[t] + p.ϕ_11 * v.CO2_AT[t-1] + p.ϕ_21 * v.CO2_UP[t-1]\n            # Equation for CO2_UP \n            v.CO2_UP[t] = p.ϕ_12 * v.CO2_AT[t-1] + p.ϕ_22 * v.CO2_UP[t-1] + p.ϕ_32 * v.CO2_LO[t-1]\n            # Equation for CO2_LO \n            v.CO2_LO[t] = p.ϕ_23 * v.CO2_UP[t-1] + p.ϕ_22 * v.CO2_LO[t-1]\n            # radiative forcing other \n            v.FEX[t] = v.FEX[t-1] + p.fex \n            # Radiative forcing \n            v.F[t] = p.F2CO2 * log2(v.CO2_AT[t]/p.CO2_AT_PRE) + v.FEX[t]\n            # Atmospheric temperature \n            v.T_AT[t] = v.T_AT[t-1] + p.t_1 * (v.F[t] - p.F2CO2 / p.S * v.T_AT[t-1] - p.t_2 * (v.T_AT[t-1] - v.T_LO[t-1]))\n            # Lower ocean temperature\n            v.T_LO[t] = v.T_LO[t-1] + p.t_3 * (v.T_AT[t-1] - v.T_LO[t-1])\n        end\n    end\nend\n","category":"page"},{"location":"Julia for IAM/economy_component/#The-Economy-Component","page":"Economy Component","title":"The Economy Component","text":"","category":"section"},{"location":"Julia for IAM/economy_component/","page":"Economy Component","title":"Economy Component","text":"We describe here a really simple toy world economy, with gross output and capital evolving according to fixed parameters and exogeneous variables.","category":"page"},{"location":"Julia for IAM/economy_component/#Endogeneous-Variables","page":"Economy Component","title":"Endogeneous Variables","text":"","category":"section"},{"location":"Julia for IAM/economy_component/","page":"Economy Component","title":"Economy Component","text":"Notation Description Equation\nY_t Gross output Y_t = TFP_t * K_t^beta * L_t^(1-beta)\nK_t Capital K_t = (1 - delta) * K_t-1 + Y_t-1 * s_t-1","category":"page"},{"location":"Julia for IAM/economy_component/#Parameters","page":"Economy Component","title":"Parameters","text":"","category":"section"},{"location":"Julia for IAM/economy_component/","page":"Economy Component","title":"Economy Component","text":"Notation Description\ndelta Depreciation rate on capital\nbeta Capital share","category":"page"},{"location":"Julia for IAM/economy_component/#Exogeneous-Variables","page":"Economy Component","title":"Exogeneous Variables","text":"","category":"section"},{"location":"Julia for IAM/economy_component/","page":"Economy Component","title":"Economy Component","text":"Notation Description\nL_t Labor\nTFP_t Total factor productivity\ns_t Savings rate","category":"page"},{"location":"Julia for IAM/economy_component/#Julia-Implementation","page":"Economy Component","title":"Julia Implementation","text":"","category":"section"},{"location":"Julia for IAM/economy_component/","page":"Economy Component","title":"Economy Component","text":"Let's first implement the economy component:","category":"page"},{"location":"Julia for IAM/economy_component/","page":"Economy Component","title":"Economy Component","text":"# gross economy component\n@defcomp grosseconomy begin \n    Y = Variable(index = [time]) # Gross output \n    K = Variable(index = [time]) # Capital \n    L = Parameter(index = [time]) # Labor\n    TFP = Parameter(index = [time]) # Total factor productivity \n    s = Parameter(index = [time]) # Savings rate\n    δ = Parameter() # Depreciation rate on capital \n    k0 = Parameter() # Initial level of capital \n    β = Parameter() # Capital share\n\n    function run_timestep(p, v, d, t)\n        # Define an equation for K \n        if is_first(t)\n            # Note the use of v. and p. to distinguish between variables \n            # and parameters \n            v.K[t] = p.k0 \n        else\n            v.K[t] = (1 - p.δ) * v.K[t-1] + v.Y[t-1] * p.s[t-1]\n        end\n\n        # Define an equation for YGROSS \n        v.Y[t] = p.TFP[t] * v.K[t]^p.β * p.L[t]^(1-p.β)\n    end\nend","category":"page"},{"location":"Climate Investing/benchmark_climate/#Climate-Investing","page":"Climate Investing","title":"Climate Investing","text":"","category":"section"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"We now turn to the use of climate costs for passive management (optimized portfolio)","category":"page"},{"location":"Climate Investing/benchmark_climate/#Benchmark-Climate-Costs","page":"Climate Investing","title":"Benchmark Climate Costs","text":"","category":"section"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"Let's first create a struct Benchmark to store the main information we have:","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"Base.@kwdef mutable struct Benchmark\n    b::Vector{Float64} # benchmark weights\n    c::Vector{Float64} # Climate costs per $ mv\n    σ::Vector{Float64} # Volatility \n    ρ::Matrix # Correlation matrix\n    Σ::Union{Matrix,Nothing} = nothing # Covariance Matrix\nend\n\n\nour_benchmark = Benchmark(b = [0.23, 0.19, 0.17, 0.13, 0.09, 0.08, 0.06, 0.05],\n                        c= [0.06, 0.8, 0.39, 0.01, 0.05, 0.13, 0.5, 0.45],\n                        σ = [0.22, 0.20, 0.25, 0.18, 0.35, 0.23, 0.13, 0.29],\n                        ρ = ρ)","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"Given the Climate costs per $ mv and the respective weights for each issuer, how to compute the benchmark associated climate costs? ","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"We have:","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"C^costs(b) = sum^8_i=1b_i c^costs_i*MV","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"=b^TC^costs*MV","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"Where C^costs is the climate costs associated with the benchmark, b is the vector of weights of the benchmark, c^costs is the climate costs per of market value and MV is the overall market value of the benchmark.","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"Let's implement it in Julia:","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"function get_benchmark_climate_costs(bench::Benchmark, mv::Int)::Float64\n    return - round(bench.b' * bench.c * mv; digits= 2)\nend\n\nget_benchmark_climate_costs(our_benchmark, 1000) # suppose the MV of the benchmark is 1000 billions of USD","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"The output is:","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"-300.8","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"Which means that the benchmark climate negative externalities amount 300.8 billion USD!","category":"page"},{"location":"Climate Investing/benchmark_climate/#Climate-Benefits-to-Society","page":"Climate Investing","title":"Climate Benefits to Society","text":"","category":"section"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"Having the previous benchmark, let's assume a portfolio with the same issuers than the benchmark, but different weights x. How can we compare the relative performance of the tilted portfolio compared to the benchmark? ","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"We can compute the \"climate benefits to society\", meaning the avoided climate-related costs with the portfolio:","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"C^benefits = - (x-b)^T c * MV","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"Base.@kwdef mutable struct TiltedPortfolio\n    x::Vector{Float64} # Optimal weights\nend\n\nother_portfolio = TiltedPortfolio(x = [0.30, 0.10, 0.08, 0.02, 0.48, 0.01, 0.005, 0.0055])\n\nfunction get_climate_benefits(portfolio::TiltedPortfolio, bench::Benchmark, mv::Int)::Float64 \n    return -1 * round((portfolio.x - bench.b)' * bench.c * mv;digits = 5)\nend\n\nget_climate_benefits(other_portfolio, our_benchmark,1000)","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"Which gives:","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"141.125","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"It means that investing in the tilted portfolio defined previously allows to reduce by 141 billion USD the climate-related costs!","category":"page"},{"location":"Climate Investing/benchmark_climate/#Climate-Benefits-vs.-Tracking-Error-Control:-The-Efficiency-Frontier","page":"Climate Investing","title":"Climate Benefits vs. Tracking Error Control: The Efficiency Frontier","text":"","category":"section"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"An interesting arbitrage to evaluate is the one regarding maximizing climate benefits for society while minimizing the tracking error control. We will then draw the corresponding efficiency frontier.","category":"page"},{"location":"Climate Investing/benchmark_climate/#Tracking-Error-Volatility","page":"Climate Investing","title":"Tracking Error Volatility","text":"","category":"section"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"The tracking error volatility can be computed such as:","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"sigma(xb) = sqrt(x-b)^TSigma(x-b)","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"using LinearAlgebra\nfunction get_cov_from_corr!(bench::Benchmark)::Benchmark\n    D = diagm(bench.σ) # diagonal matrix of volatiltiy\n    bench.Σ = D * bench.ρ * D # multiplying columns and rows of correlation matrix by volatiltiy\n    return bench\nend\n\nget_cov_from_corr!(our_benchmark)\n\nfunction tracking_error_volatility(portfolio::TiltedPortfolio, bench::Benchmark)::Float64\n    return sqrt((portfolio.x - bench.b)' * bench.Σ * (portfolio.x - bench.b))\nend ","category":"page"},{"location":"Climate Investing/benchmark_climate/#Tracking-Error-Control","page":"Climate Investing","title":"Tracking Error Control","text":"","category":"section"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"The objective function is","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"x^*(gamma) = argmin frac12x^TSigma x-x^T(gamma * -c +Sigma b)","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"(ie. the efficient portfolio must reduce the climate-related costs while minimizing the tracking error volatility compared to the benchmark, with respect to the gamma parameter or risk aversion parameter).","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"The constraints are simply:\n1^Tx=1\n(ie. the weights must sum to one)\n0leq x leq 1\n(ie. the weights must be between 0 and 1)","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"using JuMP, COSMO # for the optimization\n\n\n# tilt the benchmark according to gamma\nfunction portfolio_tilting(bench::Benchmark, γ::Float64)::TiltedPortfolio\n    n = length(bench.c) # number of assets\n    model = JuMP.Model(COSMO.Optimizer)\n    # the optimal weights we want to find\n    @variable(model, x[1:n])\n    @objective(model, Min, 1/2 * x' * bench.Σ * x - x' * (γ * -1 * bench.c + bench.Σ * bench.b))\n    @constraint(model, zeros(n) .<= x .<= ones(n))\n    @constraint(model, ones(n)' * x == 1)\n    JuMP.optimize!(model)\n    portfolio = TiltedPortfolio(x = JuMP.value.(x))\n    return portfolio\nend\n\n\n\n# simulate for gammas between 0 and 10\nusing Plots\ngammas = [i for i in 0.0:0.001:0.012]\nclimate_benefits = zeros(length(gammas))\nexcess_te = zeros(length(gammas))\n\nfor i in 1:length(gammas)\n    new_portfolio = portfolio_tilting(our_benchmark, gammas[i])\n    climate_benefits[i] = get_climate_benefits(new_portfolio, our_benchmark, 1000) # suppose 1000 billion of MV for the benchmark\n    excess_te[i] = tracking_error_volatility(new_portfolio, our_benchmark) * 100\nend\n\n\n\nplot(excess_te, climate_benefits, xlabel = \"Tracking error volatility (in %)\",\n                                ylabel = \"Climate benefits for society (in billion USD)\",\n                                label = \"\")","category":"page"},{"location":"Climate Investing/benchmark_climate/","page":"Climate Investing","title":"Climate Investing","text":"(Image: \"efficiency frontier\")","category":"page"},{"location":"#Introduction","page":"Home","title":"Introduction","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The objective of this website is to explain how to conduct externalities valuation with Julia. ","category":"page"},{"location":"#ESG-Valuation:-Correcting-a-Market-Failure","page":"Home","title":"ESG Valuation: Correcting a Market Failure","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"ESG issues are extra-financial topics reflecting in externalities to society, coming from business activities. \nThese externalities are not priced-in and reflects a market failure (failure to price these externalities in a way that businesses activities can internalize it and change behavior accordingly)\nESG valuation is a way to correct this market failure, associating costs to these externalities, allowing investors to adjust financial decisions based on the ESG-adjusted valuation","category":"page"},{"location":"#Externalities-as-Market-Failure","page":"Home","title":"Externalities as Market Failure","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Economic activity generates residuals / costs to society\nSome residuals are priced (at least partially) by markets:\nsome waste for example\nBut vast majority of residuals are not priced by markets :\nCO2 emissions, air pollution, most waste, water depletion, workers health and safety incidents, etc.\nIf these residuals were priced, firms and consumers could internalize the associated costs\nIf not priced, these costs to society are hidden or external (we call about externalities):\nthen allocation of resources within the economic / financial system may be inefficient\nthen measures of macroeconomic output and companies fundamentals may be inaccurate","category":"page"},{"location":"#Correcting-Market-Failure","page":"Home","title":"Correcting Market Failure","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Business activities must face cost of externalities\nTo do so, one need to estimate ESG impacts (the costs to society)\nOne approach used are the Integrated Assessment Models (IAMs) to estimate health effects and monetary damages\nHowever, ESG valuation can face some pitfalls:\nUncertainty (parameters values, data estimates)\nValuation and ethics (discount rate in the case of expected future damages of climate change for example)","category":"page"},{"location":"#Conceptual-Modeling","page":"Home","title":"Conceptual Modeling","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"ESG valuation allows for more accurate financial assessment, taking into account the hidden costs from business activties\nThe approach pledges for an ESG integration into traditional accounting methods","category":"page"},{"location":"#Sustainability-as-a-Benefit-Cost-to-Society-Analysis","page":"Home","title":"Sustainability as a Benefit-Cost to Society Analysis","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The rationale behing ESG valuation is such that:\nactivity is sustainable and worth doing if benefits (financial and extra-financial) are higher than costs (including costs to society)","category":"page"},{"location":"#Empirical-Methods","page":"Home","title":"Empirical Methods","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"ESG Valuation can be empirically conducted with:\na modeling approach linking impacts drivers (eg. GHG emissions) and outcomes to society (eg. impacts on human health, crop yields, etc.)\na valuation approach to translate various damages in monetary terms\ndetermining a social cost (price) of the ESG issue by determining marginal damages associated with this ESG issue\napplying this social cost to the company's externalities","category":"page"},{"location":"#Integrated-Assessment-Models","page":"Home","title":"Integrated Assessment Models","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Integrated Assessment Models (IAMs) are a common tool to connect economic / anthropogenic activities with envrionmental consequences\nIAMs have been applied to various contexts:\nClimate change\nAir pollution\nWater depletion\nIAMs embody a damage function approach: ESG issues assessed with this approach would be translated in damages to human health, materials, etc.","category":"page"},{"location":"#Valuation","page":"Home","title":"Valuation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The valuation step aims for translating damages in monetary terms \nIt provides a common metric for:\nranking damages caused by differents ESG issues (climate change, air pollution, health & security for workers, etc;)\naggregation across different damages types (deaths, illness, crop yields, material depreciation) and different ESG issues (leading to an overall ESG costs valuation)","category":"page"},{"location":"#Social-Cost","page":"Home","title":"Social Cost","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Once damages and valuation is performed, we can compute the social cost per additional unit of residuals (eg. GHG emissions, air pollutant emitted) produced by the economic activity \nWhen using IAMs, social cost is determined through the computation of a marginal model:\nmodel the damages and associated cost with a baseline scenario\nrepeat the process after including a small amount of additional residuals to determine the impact on the total cost of related damages\nthe increase in damages from the additional emissions provides an estimated of the SCC.","category":"page"},{"location":"#An-Illustrative-Example-with-Julia","page":"Home","title":"An Illustrative Example with Julia","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Let's run an A to Z ESG valuation in an illustrative example, applied to the field of climate change only.","category":"page"},{"location":"#Financial-and-Extrafinancial-Statement","page":"Home","title":"Financial and Extrafinancial Statement","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"At first, let's begin with the extra-financial and financial statement of a company a:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Base.@kwdef mutable struct CompanyResults\n    revenue::Float64 # Revenue in billion USDs\n    ghg_emissions::Float64 # GHG emissions in milions tonnes of CO2eq \n    climate_costs::Union{Nothing,Float64} = nothing # Climate-related damages to society from the company, in Billion USD\nend\n\n\ncompany_a = CompanyResults(revenue = 164.2, ghg_emissions =  374)","category":"page"},{"location":"","page":"Home","title":"Home","text":"In a sustainability (climate change is the only issue assessed in this example) point of view, does it worth to invest in this company? This is the question we will try to answer with this illustrative example.","category":"page"},{"location":"#Climate-Valuation","page":"Home","title":"Climate Valuation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Let's take as given a SCC at 51/ton of CO2 (value taken by the Biden administration), and let's compute the climate-related costs from this company's emissions:","category":"page"},{"location":"","page":"Home","title":"Home","text":"## GHG emissions valuation \nusing Plots\n\nfunction climate_valuation!(data::CompanyResults, scc::Float64)::CompanyResults\n    data.climate_costs = - data.ghg_emissions * scc * 10^(-3) # to express in billion USD\n    legend_axis = [\"Revenue\", \"Climate Costs\"]\n    display(bar(legend_axis, vcat(data.revenue, data.climate_costs), orientation = :horizontal, bar_width = 1, legend = nothing, xlabel = \"Billion USD\",\n    colour = [\"blue\",\"green\"]))\n    return data\nend\n\nclimate_valuation!(company_a, 51.)","category":"page"},{"location":"","page":"Home","title":"Home","text":"(Image: \"example valuation\")","category":"page"}]
}
