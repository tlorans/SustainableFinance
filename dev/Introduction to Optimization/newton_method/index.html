<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Newton&#39;s Method · Julia for Sustainable Finance</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><script src="../../../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Julia for Sustainable Finance</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Introduction to Optimization</span><ul><li><a class="tocitem" href="../bisection_algorithm/">Bisection Algorithm</a></li><li class="is-active"><a class="tocitem" href>Newton&#39;s Method</a><ul class="internal"><li><a class="tocitem" href="#Finite-difference-method"><span>Finite difference method</span></a></li><li><a class="tocitem" href="#Back-to-Newton&#39;s-method"><span>Back to Newton&#39;s method</span></a></li><li><a class="tocitem" href="#Example"><span>Example</span></a></li></ul></li><li><a class="tocitem" href="../derivatives_jacobian/">Derivatives &amp; Jacobian</a></li></ul></li><li><span class="tocitem">Introduction to Portfolio Optimization</span><ul><li><a class="tocitem" href="../../Portfolio Optimization/portfolio_simulation/">Portfolio Simulation</a></li><li><a class="tocitem" href="../../Portfolio Optimization/qp_formulation/">QP Formulation</a></li></ul></li><li><span class="tocitem">ESG Investing</span><ul><li><a class="tocitem" href="../../ESG Investing/scoring_system/">Scoring System</a></li><li><a class="tocitem" href="../../ESG Investing/qp_problem_for_tilting/">QP Problem for Tilting</a></li><li><a class="tocitem" href="../../ESG Investing/qp_problem_for_enhanced_esg/">QP Problem for Enhanced ESG Score</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Introduction to Optimization</a></li><li class="is-active"><a href>Newton&#39;s Method</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Newton&#39;s Method</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tlorans/SustainableFinance/blob/master/docs/src/Introduction to Optimization/newton_method.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Newton&#39;s-method"><a class="docs-heading-anchor" href="#Newton&#39;s-method">Newton&#39;s method</a><a id="Newton&#39;s-method-1"></a><a class="docs-heading-anchor-permalink" href="#Newton&#39;s-method" title="Permalink"></a></h1><p>Newton&#39;s method is a root-finding algorithm which produces successively better approximations to the roots (or zeros) of a real-valued function.</p><p>The idea is to start with an initial guess which is reasonably close to the true root, then to approximate the function by its tangent line using calculus, and finally to compute the x-intercept of this tangent line by algebra.</p><p>The equation of the tangent line to the curve <span>$y = f(x)$</span> at <span>$x = x_n$</span> is:</p><p class="math-container">\[y = f&#39;(x_n)(x-x_n)+f(x_n)\]</p><p>Where <span>$f&#39;$</span> denotes the derivative.</p><p>The derivative of <span>$f$</span> shows its rate of change with respect to <span>$x$</span>. Assuming no knowledge of calculs, we use an approximation method called finite difference method to replace the derivative term.</p><h2 id="Finite-difference-method"><a class="docs-heading-anchor" href="#Finite-difference-method">Finite difference method</a><a id="Finite-difference-method-1"></a><a class="docs-heading-anchor-permalink" href="#Finite-difference-method" title="Permalink"></a></h2><p>Finite differences approximate the derivatives of functions via discretizations. Three types are commonly considerd: forward, backward and central finite differences. Here we will introduce central finite differences only, because it gives the best approximation of the derivative.</p><p>Consider <span>$f(x)$</span> and its derivative at <span>$x = a$</span>, i.e., <span>$f&#39;(a)$</span>. A central finite difference approximation of the derivative is given by:</p><p class="math-container">\[f&#39;(a) = \frac{f(a+h) - f(a-h)}{2h}\]</p><p>The finite difference method relies on discretizing a function on a grid.</p><h2 id="Back-to-Newton&#39;s-method"><a class="docs-heading-anchor" href="#Back-to-Newton&#39;s-method">Back to Newton&#39;s method</a><a id="Back-to-Newton&#39;s-method-1"></a><a class="docs-heading-anchor-permalink" href="#Back-to-Newton&#39;s-method" title="Permalink"></a></h2><p>We now replace the derivative in <span>$y = f&#39;(x_n)(x - x_n) + f(x_n)$</span> with its finite difference approximation.</p><p>To find a root of <span>$f(x)$</span>, we set <span>$y=0$</span>.</p><p class="math-container">\[y = \frac{f(x_n+h) - f(x_n - h)}{2h}(x-x_n)+f(x_n)=0\]</p><p>and </p><p class="math-container">\[x = x_n - 2h \frac{f(x_n)}{f(x_n+h)-f(x_n-h)}\]</p><p>To use this last formula iteratively, we use the following succession rule:</p><p class="math-container">\[x_n+1 = x_n - 2h \frac{f(x_n)}{f(x_n+h)-f(x_n-h)}\]</p><p>Starting with an initial guess, <span>$x_0$</span>, that is near the solution, we can iterate to find the root. It is important to choose a sufficiently smalll <span>$h$</span> to reduce the discretization error.</p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>Let&#39;s consider the same example than with the bisection algorithm: we consider <span>$f(x) = (x-1)^2 - 4$</span>.</p><p>We know <span>$f(3) = 0$</span> ; hence <span>$x = 3$</span> is a root of <span>$f(x)$</span>. We pick <span>$x_0 = 2$</span> as the initial guess.</p><p>In Julia:</p><pre><code class="language-julia hljs">function f(x)
    return (x-1)^2 - 4
end

x₀ = 2; h = 0.01/2; # initial guess x₀ and step size h 
delta = 1e-9; # set a convergence threshold

# set a max iteration so we don&#39;t get stuck in the loop 
MAX_ITER = 100;
N = 1; # counter for iteration 
while N &lt; MAX_ITER
    # evaluate f at current guess 
    f₀ = f(x₀ - h); # f(xₙ - h)
    f₁ = f(x₀); # f(xₙ)
    f₂ = f(x₀ + h); # f(xₙ + h)
    df = f₂ - f₀ # approximate the derivative with finite difference
    if abs(df) &lt; delta 
        println(&quot;Newton&#39;s method did not converge; derivative is near zero.&quot;)
        break 
    else
        dx = -2*h * (f₁ / (f₂ - f₀)); # finite difference approximation
    end
    if abs(dx) &lt; delta
        println(&quot;Converged at iteration: N = &quot;, N)
        break 
    else
        x₀ = x₀ + dx; # find next xₙ
    end
    N += 1;
end

print(&quot;root: &quot;, x₀, &quot;\n&quot;)
print(&quot;f(root): &quot;, f(x₀), &quot;\n&quot;) </code></pre><p>Which gives:</p><pre><code class="nohighlight hljs">Converged at iteration: N = 6
root: 3.000000000000002
f(root): 8.881784197001252e-15</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bisection_algorithm/">« Bisection Algorithm</a><a class="docs-footer-nextpage" href="../derivatives_jacobian/">Derivatives &amp; Jacobian »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Thursday 17 February 2022 06:46">Thursday 17 February 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
